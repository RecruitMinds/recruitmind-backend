// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Interview {
  id          String               @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String?
  skillLevel  SkillLevel
  status      InterviewStatus      @default(PENDING)
  recruiterId String               @db.ObjectId
  recruiter   Recruiter            @relation(fields: [recruiterId], references: [id])
  candidates  CandidateInterview[]
  createdAt   DateTime             @default(now())
  updatedAt   DateTime             @updatedAt

  @@map("interviews")
}

model Candidate {
  id         String               @id @default(auto()) @map("_id") @db.ObjectId
  firstName  String
  lastName   String
  email      String               @unique
  interviews CandidateInterview[]
  createdAt  DateTime             @default(now())
  updatedAt  DateTime             @updatedAt

  @@map("candidates")
}

model CandidateInterview {
  id              String          @id @default(auto()) @map("_id") @db.ObjectId
  candidateId     String          @db.ObjectId
  interviewId     String          @db.ObjectId
  status          InterviewStatus @default(INVITED)
  invitationToken String          @unique
  results         Json?
  candidate       Candidate       @relation(fields: [candidateId], references: [id])
  interview       Interview       @relation(fields: [interviewId], references: [id])
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@map("candidate_interviews")
}

model Recruiter {
  id         String      @id @default(auto()) @map("_id") @db.ObjectId
  name       String
  email      String      @unique
  interviews Interview[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt

  @@map("recruiters")
}

enum SkillLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

enum InterviewStatus {
  PENDING
  INVITED
  STARTED
  COMPLETED
}
